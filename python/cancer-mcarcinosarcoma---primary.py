# Victor W Zhong, Juhaeri Juhaeri, Stephen R Cole, Christian M Shay, Carolyn A Chew-Graham, Penny Gordon-Larsen, Evangelos Kontopantelis, Elizabeth J Mayer-Davis, 2023.

import sys, csv, re

codes = [{"code":"B000z00","system":"readv2"},{"code":"B001z00","system":"readv2"},{"code":"B002z00","system":"readv2"},{"code":"B003z00","system":"readv2"},{"code":"B00zz00","system":"readv2"},{"code":"B010z00","system":"readv2"},{"code":"B011z00","system":"readv2"},{"code":"B013z00","system":"readv2"},{"code":"B01z.00","system":"readv2"},{"code":"B02z.00","system":"readv2"},{"code":"B03z.00","system":"readv2"},{"code":"B04z.00","system":"readv2"},{"code":"B055z00","system":"readv2"},{"code":"B05z.00","system":"readv2"},{"code":"B060z00","system":"readv2"},{"code":"B062z00","system":"readv2"},{"code":"B064z00","system":"readv2"},{"code":"B06z.00","system":"readv2"},{"code":"B071z00","system":"readv2"},{"code":"B072z00","system":"readv2"},{"code":"B073z00","system":"readv2"},{"code":"B07z.00","system":"readv2"},{"code":"B08z.00","system":"readv2"},{"code":"B0zz.00","system":"readv2"},{"code":"B10z.00","system":"readv2"},{"code":"B110z00","system":"readv2"},{"code":"B111z00","system":"readv2"},{"code":"B11z.00","system":"readv2"},{"code":"B12z.00","system":"readv2"},{"code":"B13z.00","system":"readv2"},{"code":"B14z.00","system":"readv2"},{"code":"B151z00","system":"readv2"},{"code":"B161z00","system":"readv2"},{"code":"B16z.00","system":"readv2"},{"code":"B17z.00","system":"readv2"},{"code":"B180z00","system":"readv2"},{"code":"B18z.00","system":"readv2"},{"code":"B1z1z00","system":"readv2"},{"code":"B1zz.00","system":"readv2"},{"code":"B200z00","system":"readv2"},{"code":"B201z00","system":"readv2"},{"code":"B20z.00","system":"readv2"},{"code":"B213z00","system":"readv2"},{"code":"B215.00","system":"readv2"},{"code":"B21z.00","system":"readv2"},{"code":"B220z00","system":"readv2"},{"code":"B221z00","system":"readv2"},{"code":"B222z00","system":"readv2"},{"code":"B223z00","system":"readv2"},{"code":"B224z00","system":"readv2"},{"code":"B22z.00","system":"readv2"},{"code":"B23z.00","system":"readv2"},{"code":"B241z00","system":"readv2"},{"code":"B24z.00","system":"readv2"},{"code":"B2zz.00","system":"readv2"},{"code":"B300z00","system":"readv2"},{"code":"B302z00","system":"readv2"},{"code":"B303z00","system":"readv2"},{"code":"B304z00","system":"readv2"},{"code":"B305z00","system":"readv2"},{"code":"B306z00","system":"readv2"},{"code":"B307z00","system":"readv2"},{"code":"B308z00","system":"readv2"},{"code":"B30z.00","system":"readv2"},{"code":"B310z00","system":"readv2"},{"code":"B311z00","system":"readv2"},{"code":"B312z00","system":"readv2"},{"code":"B313z00","system":"readv2"},{"code":"B314z00","system":"readv2"},{"code":"B315z00","system":"readv2"},{"code":"B31z.00","system":"readv2"},{"code":"B332z00","system":"readv2"},{"code":"B334z00","system":"readv2"},{"code":"B336z00","system":"readv2"},{"code":"B337z00","system":"readv2"},{"code":"B33z.00","system":"readv2"},{"code":"B340z00","system":"readv2"},{"code":"B34yz00","system":"readv2"},{"code":"B34z.00","system":"readv2"},{"code":"B35zz00","system":"readv2"},{"code":"B3z..00","system":"readv2"},{"code":"B410z00","system":"readv2"},{"code":"B41yz00","system":"readv2"},{"code":"B41z.00","system":"readv2"},{"code":"B430z00","system":"readv2"},{"code":"B431z00","system":"readv2"},{"code":"B43z.00","system":"readv2"},{"code":"B44z.00","system":"readv2"},{"code":"B450z00","system":"readv2"},{"code":"B451z00","system":"readv2"},{"code":"B45z.00","system":"readv2"},{"code":"B470z00","system":"readv2"},{"code":"B471z00","system":"readv2"},{"code":"B47z.00","system":"readv2"},{"code":"B48yz00","system":"readv2"},{"code":"B48z.00","system":"readv2"},{"code":"B49z.00","system":"readv2"},{"code":"B4A1z00","system":"readv2"},{"code":"B4Az.00","system":"readv2"},{"code":"B4z..00","system":"readv2"},{"code":"B500z00","system":"readv2"},{"code":"B501z00","system":"readv2"},{"code":"B50z.00","system":"readv2"},{"code":"B510z00","system":"readv2"},{"code":"B512z00","system":"readv2"},{"code":"B517z00","system":"readv2"},{"code":"B51yz00","system":"readv2"},{"code":"B51z.00","system":"readv2"},{"code":"B521z00","system":"readv2"},{"code":"B523z00","system":"readv2"},{"code":"B52z.00","system":"readv2"},{"code":"B540z00","system":"readv2"},{"code":"B542z00","system":"readv2"},{"code":"B545z00","system":"readv2"},{"code":"B54z.00","system":"readv2"},{"code":"B550000","system":"readv2"},{"code":"B550100","system":"readv2"},{"code":"B550200","system":"readv2"},{"code":"B550300","system":"readv2"},{"code":"B550400","system":"readv2"},{"code":"B550500","system":"readv2"},{"code":"B550z00","system":"readv2"},{"code":"B551000","system":"readv2"},{"code":"B551100","system":"readv2"},{"code":"B551200","system":"readv2"},{"code":"B551z00","system":"readv2"},{"code":"B553000","system":"readv2"},{"code":"B553z00","system":"readv2"},{"code":"B554.00","system":"readv2"},{"code":"B555.00","system":"readv2"},{"code":"B55y000","system":"readv2"},{"code":"B55y200","system":"readv2"},{"code":"B55z.00","system":"readv2"},{"code":"B591.00","system":"readv2"},{"code":"B600z00","system":"readv2"},{"code":"B601z00","system":"readv2"},{"code":"B602z00","system":"readv2"},{"code":"B60z.00","system":"readv2"},{"code":"B613z00","system":"readv2"},{"code":"B614z00","system":"readv2"},{"code":"B615z00","system":"readv2"},{"code":"B61z.00","system":"readv2"},{"code":"B61z.11","system":"readv2"},{"code":"B61z700","system":"readv2"},{"code":"B61zz00","system":"readv2"},{"code":"B620z00","system":"readv2"},{"code":"B621z00","system":"readv2"},{"code":"B622z00","system":"readv2"},{"code":"B623z00","system":"readv2"},{"code":"B624z00","system":"readv2"},{"code":"B625z00","system":"readv2"},{"code":"B627C11","system":"readv2"},{"code":"B62y.00","system":"readv2"},{"code":"B62y700","system":"readv2"},{"code":"B62yz00","system":"readv2"},{"code":"B63z.00","system":"readv2"},{"code":"B651z00","system":"readv2"},{"code":"B65yz00","system":"readv2"},{"code":"B65z.00","system":"readv2"},{"code":"B66yz00","system":"readv2"},{"code":"B66z.00","system":"readv2"},{"code":"B681.00","system":"readv2"},{"code":"B68z.00","system":"readv2"},{"code":"B6z..00","system":"readv2"},{"code":"B91zz00","system":"readv2"},{"code":"BB0..00","system":"readv2"},{"code":"BB1..00","system":"readv2"},{"code":"BB11.00","system":"readv2"},{"code":"BB12.00","system":"readv2"},{"code":"BB13.00","system":"readv2"},{"code":"BB19.00","system":"readv2"},{"code":"BB2z.00","system":"readv2"},{"code":"BB3z.00","system":"readv2"},{"code":"BB52.00","system":"readv2"},{"code":"BB53.00","system":"readv2"},{"code":"BB5T100","system":"readv2"},{"code":"BB5X100","system":"readv2"},{"code":"BB5f100","system":"readv2"},{"code":"BB6z.00","system":"readv2"},{"code":"BB7z.00","system":"readv2"},{"code":"BB80100","system":"readv2"},{"code":"BB81200","system":"readv2"},{"code":"BB81500","system":"readv2"},{"code":"BB81E00","system":"readv2"},{"code":"BB81z00","system":"readv2"},{"code":"BB8z.00","system":"readv2"},{"code":"BB93.00","system":"readv2"},{"code":"BB9z.00","system":"readv2"},{"code":"BBAz.00","system":"readv2"},{"code":"BBE1.13","system":"readv2"},{"code":"BBED.00","system":"readv2"},{"code":"BBF1.00","system":"readv2"},{"code":"BBF2.00","system":"readv2"},{"code":"BBG1.00","system":"readv2"},{"code":"BBGM.00","system":"readv2"},{"code":"BBGz.00","system":"readv2"},{"code":"BBHz.00","system":"readv2"},{"code":"BBJ1.00","system":"readv2"},{"code":"BBJBz00","system":"readv2"},{"code":"BBJz.00","system":"readv2"},{"code":"BBK0200","system":"readv2"},{"code":"BBK0z00","system":"readv2"},{"code":"BBK1z00","system":"readv2"},{"code":"BBK2z00","system":"readv2"},{"code":"BBK3100","system":"readv2"},{"code":"BBK3z00","system":"readv2"},{"code":"BBKz.00","system":"readv2"},{"code":"BBL9.00","system":"readv2"},{"code":"BBLz.00","system":"readv2"},{"code":"BBM8.00","system":"readv2"},{"code":"BBNz.00","system":"readv2"},{"code":"BBQ1z00","system":"readv2"},{"code":"BBQ7100","system":"readv2"},{"code":"BBQ7200","system":"readv2"},{"code":"BBQ7z00","system":"readv2"},{"code":"BBTDz00","system":"readv2"},{"code":"BBV0.00","system":"readv2"},{"code":"BBV7.00","system":"readv2"},{"code":"BBW1.00","system":"readv2"},{"code":"BBW2.00","system":"readv2"},{"code":"BBW3.00","system":"readv2"},{"code":"BBW4.00","system":"readv2"},{"code":"BBWz.00","system":"readv2"},{"code":"BBc2.00","system":"readv2"},{"code":"BBg..00","system":"readv2"},{"code":"BBg1.00","system":"readv2"},{"code":"BBg1.11","system":"readv2"},{"code":"BBg1000","system":"readv2"},{"code":"BBg5.00","system":"readv2"},{"code":"BBg6.00","system":"readv2"},{"code":"BBgB.00","system":"readv2"},{"code":"BBgK.00","system":"readv2"},{"code":"BBgR.00","system":"readv2"},{"code":"BBgz.00","system":"readv2"},{"code":"BBh0.00","system":"readv2"},{"code":"BBj0.00","system":"readv2"},{"code":"BBj6.00","system":"readv2"},{"code":"BBjz.00","system":"readv2"},{"code":"BBk0.00","system":"readv2"},{"code":"BBk0.12","system":"readv2"},{"code":"BBkz.00","system":"readv2"},{"code":"BBlz.00","system":"readv2"},{"code":"BBr0000","system":"readv2"},{"code":"BBr0100","system":"readv2"},{"code":"BBr0300","system":"readv2"},{"code":"BBr0400","system":"readv2"},{"code":"BBr4z00","system":"readv2"},{"code":"BBr6000","system":"readv2"},{"code":"BBr6z00","system":"readv2"},{"code":"BBr8z00","system":"readv2"},{"code":"BBr9000","system":"readv2"},{"code":"BBrz.00","system":"readv2"},{"code":"ByuDF11","system":"readv2"},{"code":"Bz...00","system":"readv2"}];
REQUIRED_CODES = 1;
with open(sys.argv[1], 'r') as file_in, open('cancer-potential-cases.csv', 'w', newline='') as file_out:
    csv_reader = csv.DictReader(file_in)
    csv_writer = csv.DictWriter(file_out, csv_reader.fieldnames + ["cancer-mcarcinosarcoma---primary-identified"])
    csv_writer.writeheader();
    codes_identified = 0;
    for row in csv_reader:
        newRow = row.copy();
        for cell in row:
            # Iterate cell lists (e.g. codes)
            for item in re.findall(r'\(([^,]*)\,', row[cell]):
                if(item in list(map(lambda code: code['code'], codes))): codes_identified+=1;
                if(codes_identified>=REQUIRED_CODES):
                    newRow["cancer-mcarcinosarcoma---primary-identified"] = "CASE";
                    break;
            if(codes_identified>=REQUIRED_CODES): break;
        if(codes_identified<REQUIRED_CODES):
            newRow["cancer-mcarcinosarcoma---primary-identified"] = "UNK";
        codes_identified=0;
        csv_writer.writerow(newRow)
